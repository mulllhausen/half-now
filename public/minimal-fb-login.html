<button id="facebook">facebook</button><br>
<script type="module">
// use a module because otherwise we get this error:
// Uncaught SyntaxError: Cannot use import statement outside a module

// Import the functions you need from the SDKs you need
import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js';
import {
    getAuth,
    signInWithRedirect,
    FacebookAuthProvider,
    getRedirectResult,
    signOut,
    onAuthStateChanged
} from 'https://www.gstatic.com/firebasejs/9.17.2/firebase-auth.js';

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
// from https://console.firebase.google.com/project/half-now/settings/general/w
const firebaseConfig = {
  apiKey: "AIzaSyD1j1JxchDa4kCjIVxKPpZTFZDc9a084fw",
  authDomain: "half-now.firebaseapp.com",
  databaseURL: "https://half-now-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "half-now",
  storageBucket: "half-now.appspot.com",
  messagingSenderId: "1022216288188",
  appId: "1:1022216288188:web:fbf335e1f0918eb1345db9",
  measurementId: "G-04C5HYLHKH"
};
// Initialize Firebase
const firebase = initializeApp(firebaseConfig);
//const analytics = getAnalytics(app);
const auth = getAuth(firebase);
//const user = auth.currentUser; // note: unreliable. is null even when user is logged in

document.getElementById('facebook').addEventListener('click', () => facebookSignIn(auth), false);

// https://firebase.google.com/docs/auth/web/manage-users
onAuthStateChanged(auth, user => {
    if (user) {
        console.log('user is logged in', user);
        // https://firebase.google.com/docs/reference/js/firebase.User
        console.log(halfNowGlobals.userData);
    } else {
        console.log('user is not logged in');
    }
});

function facebookSignIn(auth) {
    // https://firebase.google.com/docs/auth/web/google-signin
    if (!auth.currentUser) {
        const provider = new FacebookAuthProvider();
        provider.addScope('email'); // get the user's email address for linking accounts. maybe not necessary...
        signInWithRedirect(auth, provider);
    } else {
        renderUserData(auth.currentUser);
        //firebase.auth().signOut();
    }
}
</script>
